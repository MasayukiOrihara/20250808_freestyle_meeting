generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model HumanProfile {
  id                       Int      @id @default(autoincrement())
  name                     String
  age                      String
  sex                      String
  occupation               String
  location                 String
  interests                String[]
  personalityTraits        String
  motivation               String
  communicationPreference  String
  prohibitedExpressions    String
  lifestyle                String
  weeklyRoutine            String
  hobbies                  String[]
  dislikes                 String[]
  sessionId                String
}

/* freestyle parsona AI で扱うベクターデータを更新するかしないかのハッシュ */
model FileHashGroup {
  id     Int      @id @default(autoincrement())
  key    String   @unique
  hashes String[]
}

/** 会話履歴を取り扱う */ 
model Conversation {
  id          String    @id @default(uuid())
  userId      String
  sessionId   String
  startedAt   DateTime  @default(now())
  endedAt     DateTime?
  messages    Message[]
  metadata    Json?     // 任意の追加情報を保存可能
}

model Message {
  id             String      @id @default(uuid())
  conversationId String
  role           String      // "user" or "ai" など
  content        String
  createdAt      DateTime    @default(now())
  metadata       Json?       // トークン数や感情分析などの情報

  conversation   Conversation @relation(fields: [conversationId], references: [id])
}